const e={update:(e,t,s)=>{let a="function"==typeof t[s]?t[s]():t[s];"boolean"==typeof a?a?e.setAttribute(s,""):e.removeAttribute(s):a&&e.setAttribute(s,a)}};var t={template:`
  <button class="lstBtn l-fx-b l-br">
    <span class="lstBtnIcon l-fx l-jc-center"></span>
    <span class="lstBtnText"></span>
  </button>`,directives:{_attr:e},props:{proxies:{value:{},disabled:{},error:{}},params:{name:{default:""},type:{default:"button"},size:{default:"medium"},text:{},options:{default:{}}},methods:{action:{}}},nodes(){return{lstBtn:{_class:{"l-fx-rev":"end"===this.param.options.iconPosition},_attr:{size:this.param.size},name:this.param.name,type:this.param.type,disabled:()=>this.proxy.disabled,onclick:()=>this.method.action?.(this.param.name)},lstBtnIcon:{_class:{lstSpinner:()=>this.proxy.error},_html:()=>this.param.options.icon},lstBtnText:{_text:()=>this.param.text??this.proxy.value}}},methods:{spinner(e){this.proxy.error=e}}},s={template:'<div class="lstTabs l-fx"></div><div section="content"></div>',props:{proxies:{tabs:{},selectedIndex:{default:0}},methods:{change:{}}},setters:{selectedIndex(e){return this.node.lstTabs.children[this.proxy.selectedIndex].classList.remove("l-active"),e}},handlers:{selectedIndex(e){this.node.lstTabs.children[e].classList.add("l-active")}},nodes(){return{lstTabs:{component:{iterate:()=>this.proxy.tabs,src:t,params:{name:(e,t)=>t,text:e=>e,type:"text",size:"large"},methods:{action:this.method.change}}}}},mounted(){this.node.lstTabs.children[this.proxy.selectedIndex].classList.add("l-active")}},a={template:'<tr class="lstTr"></tr>',props:{params:{index:{type:"number"},realIndex:{type:"number"}},proxies:{row:{type:"object"},_selected:{type:"array"}},methods:{action:{}}},nodes(){return{lstTr:{_evalHTML:()=>{let e=`<td>${this.param.index}</td>`;for(let[t,s]of Object.entries(this.proxy.row))e+=`<td name="${t}" title="${s}">${s}</td>`;return e},_class:{selected:()=>this.proxy._selected.includes(this.param.realIndex)},onclick:()=>this.method.action(this.proxy.row,this.param.realIndex)}}}},o={template:`<table class="lstTable">
    <tbody class="lstTableHeader"></tbody>
    <tbody class="lstTableBody"></tbody>
  </table>`,props:{params:{header:{type:"array"},options:{ignore:!0}},proxies:{_tbody:{type:"array"},_selected:{type:"array"}},methods:{action:{}}},nodes(){return{lstTableHeader:{_evalHTML:()=>this.proxy._tbody&&this.method.header(this.param.options.header())},lstTableBody:{component:{src:a,iterate:()=>this.proxy._tbody,params:{index:(e,t)=>this.param.options.index(t),realIndex:(e,t)=>t},proxies:{row:e=>e,_selected:()=>this.proxy._selected},methods:{action:this.method.action}}}}},methods:{header:e=>e?"<colgroup>"+e.reduce(e=>e+"<col />","")+"</colgroup><tr>"+e.reduce((e,t)=>e+`<th>${t}</th>`,"<th></th>")+"</tr>":""}},i={template:`
  <dialog class="lstDialog l-scrollbar">
    <div class="lstClose"></div>
    <h3 class="lstDialogHd"></h3>
    <p class="lstDialogTxt"></p>
    <div section="content"></div>
    <div class="l-fx l-jc-end">
      <div class="lstDialogReject"></div>
      <div class="lstDialogAllow"></div>
    </div>
  </dialog>`,props:{params:{cancelable:{},expanded:{},name:{},title:{},text:{},allow:{},reject:{}},proxies:{opened:{default:!1}},methods:{onclose:{},allow:{},reject:{}}},handlers:{opened(e){e?this.node.lstDialog.showModal():this.node.lstDialog.close()}},nodes(){return{lstDialog:{_class:{"l-full-screen":()=>this.param.expanded,["dialog_"+this.param.name]:()=>this.param.name},oncancel:e=>{this.param.cancelable?this.method.onclose():e.preventDefault()}},lstClose:{hidden:!this.param.cancelable,onclick:()=>this.method.onclose()},lstDialogHd:{_text:()=>this.param.title},lstDialogTxt:{_text:()=>this.param.text},lstDialogReject:{component:{induce:()=>this.param.reject,src:t,params:{text:()=>this.param.reject.text,type:()=>this.param.reject.type||"text"},methods:{action:()=>{this.method.reject?.(),this.method.onclose()}}}},lstDialogAllow:{component:{induce:()=>this.param.allow,src:t,params:{text:()=>this.param.allow.text,type:()=>this.param.allow.type||"text"},methods:{action:()=>{this.method.allow?.(),this.method.onclose()}}}}}},methods:{opened(e){this.proxy.opened=e}},mounted(){this.proxy.opened&&this.node.lstDialog.showModal()}},l={template:`
  <label class="lstCheckbox">
    <input type="checkbox" class="lstCheckboxInp">
    <span class="lstCheckmark"></span>
    <span class="lstCheckboxText"></span>
  </label>`,directives:{_attr:e},props:{proxies:{value:{},disabled:{},error:{}},params:{name:{default:""},size:{default:"medium"},text:{}},methods:{action:{}}},nodes(){return{lstCheckbox:{_attr:{size:this.param.size}},lstCheckboxInp:{checked:()=>this.proxy.value,onchange:e=>{this.proxy.value=e.target.checked,this.method.action?.(this.param.name,e.target.checked)}},lstCheckboxText:{_text:()=>this.param.text??""}}},methods:{set(e){this.proxy.value=e}}},r={template:'<div class="checkboxes l-content"></div>',props:{proxies:{_checkboxes:{}},methods:{change:{}}},nodes(){return{checkboxes:{component:{iterate:()=>this.proxy._checkboxes,src:l,params:{text:e=>e.title,name:(e,t)=>t},proxies:{value:e=>e.checked},methods:{action:this.method.change}}}}}},d={template:`<div class="dialog"></div>
      <div class="l-content">
      <div class="controls l-fx l-gap l-ai-c">
        <div class="settings"></div>
        <div class="count"></div>
        <div class="remove"></div>
        <div class="export"></div>
        <div class="chemistry"></div>
      </div>
      <div class="table"></div>
    </div>`,props:{params:{data:{},fields:{}}},proxies:{fields:[],data:[],selected:[],opened:!1},nodes(){return{dialog:{component:{src:i,params:{title:"Настройка таблицы",text:"Выберите поля для отображения",allow:{text:"Применить"},reject:{text:"Отмена"}},proxies:{opened:()=>this.proxy.opened},methods:{onclose:()=>this.proxy.opened=!1,reject:()=>{this.proxy.fields=this.param.fields},allow:()=>{let e=this.proxy.fields.filter(e=>e.checked).map(e=>e.key);this.proxy.data=this.method.filterObjects(this.param.data,e)}},sections:{content:{src:r,proxies:{_checkboxes:()=>this.proxy.fields},methods:{change:(e,t)=>{this.proxy.fields[e].checked=t}}}}}},count:{_text:()=>`${this.proxy.data.length} / ${this.proxy.selected.length}`},settings:{component:{src:t,params:{options:{icon:`<svg xmlns="http://www.w3.org/2000/svg" width="800px" height="800px" viewBox="0 0 24 24" fill="none">
<path d="M3 8L15 8M15 8C15 9.65686 16.3431 11 18 11C19.6569 11 21 9.65685 21 8C21 6.34315 19.6569 5 18 5C16.3431 5 15 6.34315 15 8ZM9 16L21 16M9 16C9 17.6569 7.65685 19 6 19C4.34315 19 3 17.6569 3 16C3 14.3431 4.34315 13 6 13C7.65685 13 9 14.3431 9 16Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`}},methods:{action:()=>this.proxy.opened=!0}}},remove:{component:{src:t,params:{type:"primary"},proxies:{value:()=>"Удалить",disabled:()=>0===this.proxy.selected.length},methods:{action:this.method.remove}}},export:{component:{src:t,params:{type:"primary",text:"Экспорт SCV"},methods:{action:this.method.downloadCSV}}},chemistry:{component:{src:t,params:{type:"primary",text:"Экспорт Химии"},methods:{action:()=>location.href=""}}},table:{component:{src:o,params:{options:{header:()=>this.proxy.fields.filter(e=>e.checked).map(e=>e.title),index:e=>e+1}},proxies:{_tbody:()=>this.proxy.data,_selected:()=>this.proxy.selected},methods:{action:(e,t)=>{let s=this.proxy.selected.indexOf(t);-1===s?this.proxy.selected.push(t):this.proxy.selected.splice(s,1)}}}}}},methods:{filterObjects:(e,t)=>e.map(e=>t.reduce((t,s)=>(s in e&&(t[s]=e[s]),t),{})),remove(){this.proxy.data=this.proxy.data.filter((e,t)=>!this.proxy.selected.includes(t)),this.proxy.selected=[]},convertArrayOfObjectsToCSV(e){let t="",s=this.proxy.fields.filter(e=>e.checked),a=s.map(e=>e.key);return t+=s.map(e=>`"${e.title.replace(/"/g,"")}"`).join(",")+"\n",e.forEach(e=>{a.forEach((s,a)=>{a>0&&(t+=",");let o=e[s];"string"==typeof o&&(o.includes(",")||o.includes('"')||o.includes("\n"))?o=`"${o.replace(/"/g,'""')}"`:"number"!=typeof o||isNaN(o)||(o=o.toString()),t+=o}),t+="\n"}),t},downloadCSV(){let e=this.proxy.data,t=this.method.convertArrayOfObjectsToCSV(e),s=new Blob([t],{type:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(s),a.download="data.csv",a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},created(){this.proxy.fields=this.param.fields,this.proxy.data=this.param.data}},n={template:'<div class="main l-container l-content"></div>',proxies:{selectedIndex:0},nodes(){return{main:{component:{src:s,proxies:{tabs:this.models.map(e=>e.title),selectedIndex:()=>this.proxy.selectedIndex},methods:{change:this.method.switchTab},sections:{content:{}}}}}},methods:{switchTab(e){let t=this.data.map(e=>e.selected),s=this.models[e].key,a=this.models[e].fields,o=(e,t,s)=>({...t,[s.key]:e[s.key]||"-"}),i=t.filter(e=>e[s]).map(e=>a.filter(e=>e.checked).reduce((t,s)=>o(e,t,s),{}));this.node.main.section.content.mount({src:d,params:{data:i,fields:a}}),this.proxy.selectedIndex=e}},mounted(){this.method.switchTab(this.proxy.selectedIndex)}};window.create=({data:e,models:t})=>{let s=document.querySelector("#root");lesta.createApp({data:e,models:t}).mount(n,s,{params:{}})};
//# sourceMappingURL=index.cad1d033.js.map
